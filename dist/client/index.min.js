var MockeClient=function(t){"use strict";var s={};function o(t,e){for(var r=0,n=t.length-1;0<=n;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;)t.unshift("..");return t}function r(t){return e.exec(t).slice(1)}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function c(){for(var t=arguments,e="",r=!1,n=arguments.length-1;-1<=n&&!r;n--){var i=0<=n?t[n]:"/";if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i.charAt(0))}return(r?"/":"")+(e=o(a(e.split("/"),function(t){return!!t}),!r).join("/"))||"."}function n(t){var e=i(t),r="/"===f(t,-1);return(t=!(t=o(a(t.split("/"),function(t){return!!t}),!e).join("/"))&&!e?".":t)&&r&&(t+="/"),(e?"/":"")+t}function i(t){return"/"===t.charAt(0)}var u={extname:function(t){return r(t)[3]},basename:function(t,e){return t=r(t)[2],t=e&&t.substr(-1*e.length)===e?t.substr(0,t.length-e.length):t},dirname:function(t){var t=(e=r(t))[0],e=e[1];return t||e?t+(e=e&&e.substr(0,e.length-1)):"."},sep:"/",delimiter:":",relative:function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;0<=r&&""===t[r];r--);return r<e?[]:t.slice(e,r-e+1)}t=c(t).substr(1),e=c(e).substr(1);for(var n=r(t.split("/")),i=r(e.split("/")),s=Math.min(n.length,i.length),o=s,u=0;u<s;u++)if(n[u]!==i[u]){o=u;break}for(var a=[],u=o;u<n.length;u++)a.push("..");return(a=a.concat(i.slice(o))).join("/")},join:function(){return n(a(Array.prototype.slice.call(arguments,0),function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},isAbsolute:i,normalize:n,resolve:c};function a(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var f="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)};function h(){}function p(){p.init.call(this)}function l(t){return void 0===t._maxListeners?p.defaultMaxListeners:t._maxListeners}function v(t,e,r,n){var i,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');return(i=t._events)?(i.newListener&&(t.emit("newListener",e,r.listener||r),i=t._events),s=i[e]):(i=t._events=new h,t._eventsCount=0),s?("function"==typeof s?s=i[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),s.warned||(n=l(t))&&0<n&&s.length>n&&(s.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=t,n.type=e,n.count=s.length,n=n,"function"==typeof console.warn?console.warn(n):console.log(n))):(s=i[e]=r,++t._eventsCount),t}function m(t,e,r){var n=!1;function i(){t.removeListener(e,i),n||(n=!0,r.apply(t,arguments))}return i.listener=r,i}function d(t){var e=this._events;if(e){t=e[t];if("function"==typeof t)return 1;if(t)return t.length}return 0}function g(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}h.prototype=Object.create(null),(p.EventEmitter=p).usingDomains=!1,p.prototype.domain=void 0,p.prototype._events=void 0,p.prototype._maxListeners=void 0,p.defaultMaxListeners=10,p.init=function(){this.domain=null,p.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new h,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},p.prototype.getMaxListeners=function(){return l(this)},p.prototype.emit=function(t){var e,r,n,i=arguments,s="error"===t,o=this._events;if(o)s=s&&null==o.error;else if(!s)return!1;if(u=this.domain,s){if(s=arguments[1],u)return(s=s||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,s.domain=u,s.domainThrown=!1,u.emit("error",s),!1;if(s instanceof Error)throw s;var u=new Error('Uncaught, unspecified "error" event. ('+s+")");throw u.context=s,u}if(!(e=o[t]))return!1;var a,c="function"==typeof e;switch(a=arguments.length){case 1:!function(t,e,r){if(e)t.call(r);else for(var n=t.length,i=g(t,n),s=0;s<n;++s)i[s].call(r)}(e,c,this);break;case 2:!function(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,s=g(t,i),o=0;o<i;++o)s[o].call(r,n)}(e,c,this,arguments[1]);break;case 3:!function(t,e,r,n,i){if(e)t.call(r,n,i);else for(var s=t.length,o=g(t,s),u=0;u<s;++u)o[u].call(r,n,i)}(e,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,r,n,i,s){if(e)t.call(r,n,i,s);else for(var o=t.length,u=g(t,o),a=0;a<o;++a)u[a].call(r,n,i,s)}(e,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(a-1),n=1;n<a;n++)r[n-1]=i[n];!function(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,s=g(t,i),o=0;o<i;++o)s[o].apply(r,n)}(e,c,this,r)}return!0},p.prototype.addListener=function(t,e){return v(this,t,e,!1)},p.prototype.on=p.prototype.addListener,p.prototype.prependListener=function(t,e){return v(this,t,e,!0)},p.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,m(this,t,e)),this},p.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,m(this,t,e)),this},p.prototype.removeListener=function(t,e){var r,n,i,s,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[t]))return this;if(r===e||r.listener&&r.listener===e)0==--this._eventsCount?this._events=new h:(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,s=r.length;0<s--;)if(r[s]===e||r[s].listener&&r[s].listener===e){o=r[s].listener,i=s;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new h,this;delete n[t]}else!function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,i);n.removeListener&&this.emit("removeListener",t,o||e)}return this},p.prototype.removeAllListeners=function(t){var e,r=this._events;if(!r)return this;if(!r.removeListener)return 0===arguments.length?(this._events=new h,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new h:delete r[t]),this;if(0===arguments.length){for(var n,i=Object.keys(r),s=0;s<i.length;++s)"removeListener"!==(n=i[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new h,this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)for(;this.removeListener(t,e[e.length-1]),e[0];);return this},p.prototype.listeners=function(t){var e=this._events,r=e&&(r=e[t])?"function"==typeof r?[r.listener||r]:function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(r):[];return r},p.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},p.prototype.listenerCount=d,p.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var y=function(i){function t(t,e,r,n){void 0===n&&(n={}),i.call(this),this.app=r,this.faker=n,this.name=t,this.configured=!1,this.items=[],this.startService(e)}i&&(t.__proto__=i),(t.prototype=Object.create(i&&i.prototype)).constructor=t;var e={total:{configurable:!0}};return e.total.get=function(){return this.items.length},t.prototype.startService=function(t){if("string"==typeof(e=t))var t=s.readFileSync(e,{encoding:"utf8"}),e=JSON.parse(t);else if(Array.isArray(e)||"object"!=typeof e)throw new Error('Options type cannot be "',typeof e,'"');this.configureService(e)},t.prototype.configureService=function(t){var e=t.schema,t=t.total;void 0===t&&(t=10),this.schema=e=void 0===e?{}:e,this._total=t,this.app.server&&this.registerRoutes()},t.prototype.registerRoutes=function(){var e=this,t=[{method:"GET",path:"/"+this.name+"/{id}",handler:function(t){return e.items[t.params.id-1]}},{method:"GET",path:"/"+this.name,handler:function(n){return e.items.filter(function(t){var e=parseInt(n.query.limit)||4,r=parseInt(n.query.skip)||0;return t.id<=e+r&&t.id>r})}}];this.app.server.route(t)},t.prototype.generateCachedItems=function(){this.items=[];for(var t=0;this._total>t;t++){var e=this.generateItem();this.items.push(e)}this.app.log("generated "+this.items.length+" for service "+this.name)},t.prototype.generateItem=function(t,e){for(var r=t||this.schema,n=Object.keys(r),i={id:e||this.items.length+1},s=0;n.length>s;s++){var o=n[s];i[o]=this.generateProperty(r[o])}return i},t.prototype.generateProperty=function(t){var e=t.type;void 0===e&&(e="string");var r=t.total;void 0===r&&(r=4);var n=t.properties;void 0===n&&(n={});var i=t.fakerType;if(void 0===i&&(i="lorem.text"),this.faker){if("array"!=typeof e){if("object"==typeof e)return this.generateItem(n,1);e=i.split(".");return e.length<2&&this.app.handleError("missing props"),(this.faker[e[0]][e[1]]||this.faker.lorem.text)()}for(var s,o=[],u=0;u<r;u++)return"object"===i?(s=this.generateItem(n,u+1),o.push(s)):((s=i.split(".")).length<2&&this.app.handleError("missing props"),s=(s=this.faker[s[0]][s[1]])||this.faker.lorem.text,o.push(s())),o}},t.prototype.destroy=function(){this.removeAllListeners()},t.prototype.find=function(t){var e=this,r=t.limit,t=t.skip;return this.app.transport.get(this.name+"?limit="+(r=void 0===r?4:r)+"&skip="+(t=void 0===t?0:t)).then(function(t){return{data:t.data,total:e.total}}).catch(function(t){t=t.response.data.message;e.emit("error",t)})},t.prototype.get=function(t){var e=this;return this.app.transport.get(this.name+"/"+(t=void 0===t?1:t)).then(function(t){return t.data}).catch(function(t){t=t.response.data.message;e.emit("error",t)})},t.prototype.createStore=function(){var n=this;return{namespaced:!0,state:{items:[],total:0,isFindPending:!1,isGetPending:!1},mutations:{ADD_ITEM_TO_STORE:function(t,e){!t.items.filter(function(t){return t.id===e.id})[0]&&t.items.push(e)},UPDATE_TOTAL:function(t,e){t.total=e},IS_FIND_PENDING:function(t){t.isFindPending=!0},FIND_FINISHED:function(t){t.isFindPending=!1},IS_GET_PENDING:function(t){t.isGetPending=!0},GET_FINISHED:function(t){t.isGetPending=!1}},actions:{findItems:function(t,e){var r=t.commit,t=e.limit,e=e.skip;return r("IS_FIND_PENDING"),n.find({limit:t,skip:e}).then(function(t){r("UPDATE_TOTAL",t.total),t.data.forEach(function(t){r("ADD_ITEM_TO_STORE",t)})}).finally(function(){r("FIND_FINISHED")})},getItem:function(t){return commit("IS_GET_PENDING"),n.get(t).then(function(t){commit("ADD_ITEM_TO_STORE",t)}).finally(function(){commit("GET_FINISHED")})}},getters:{getById:function(t){return function(e){return t.items.filter(function(t){return t.id===e})[0]}},findInStore:function(t){return function(e,r){return void 0===e&&(e=4),void 0===r&&(r=0),t.items.filter(function(t){return t.id<=e+r&&t.id>r})}}}}},Object.defineProperties(t.prototype,e),t}(p);return t.MockerClient=function(e){function t(t){e.call(this,t),t.transport&&(this.transport=t.transport.create({baseURL:"http://"+this._host+":"+this._port+"/"})),this.registerServices()}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.createVuexModules=function(){var e=this,r={};return Object.keys(this.services).forEach(function(t){r[t]=e.services[t].createStore()}),r},t}(function(o){function t(t){var e=this,r=t.port;void 0===r&&(r=3001);var n=t.host;void 0===n&&(n="localhost");var i=t.services;void 0===i&&(i={});var s=t.servicesPath,t=t.debug;void 0===t&&(t=!1),o.call(this),this.services={},this.faker={},this._host=n,this._port=r,this._services=i,this._servicesPath=s,this.debug=t,this.transport={get:function(t){return e.transportGet(t)}}}o&&(t.__proto__=o),(t.prototype=Object.create(o&&o.prototype)).constructor=t;var e={host:{configurable:!0},port:{configurable:!0},servicesRegistered:{configurable:!0}};return e.host.get=function(){return this._host},e.port.get=function(){return this._port},e.servicesRegistered.get=function(){return Object.keys(this.services)},t.prototype.registerServices=function(){var r,n=this;this.services={},this._servicesPath?(r=u.join(this._servicesPath),s.readdirSync(r).forEach(function(t){var e=n.checkFile(t);e&&n.registerService(e,r+"/"+t)})):this._services&&0<Object.keys(this._services).length?Object.keys(this._services).forEach(function(t){var e=n._services[t];n.registerService(t,e)}):this.handleError("No services found"),0===this.servicesRegistered.length&&this.handleError("No services found")},t.prototype.registerService=function(t,e){this.log("Registering "+t+" service");e=new y(t,e,this,this.faker);this.services[t]=e,this.log(t+" registered"),this.log(this.servicesRegistered)},t.prototype.transportGet=function(t){if(t||this.handleError("No path"),t.includes("?")){var e=t.split("?")[0],r=t.split("?")[1],n=r.split("&").filter(function(t){return t.includes("limit")})[0],i=r.split("&").filter(function(t){return t.includes("skip")})[0],n=parseInt(n.split("=")[1]),i=parseInt(i.split("=")[1]),r=this.service(e).items.filter(function(t){return t.id<=n+i&&t.id>i}),e=this.service(e).items.length;return Promise.resolve({data:r,total:e})}var e=t.split("/")[0],s=t.split("/")[1];return Promise.resolve(this.service(e).items.filter(function(t){return t.id===parseInt(s)})[0])},t.prototype.checkFile=function(t){t=t.split(".");return"json"===t.pop()?t.join("."):null},t.prototype.service=function(t){return this.services[t]||this.handleError("No service with the name "+t+" registered"),this.services[t]},t.prototype.seedServices=function(){Object.values(this.services).forEach(function(t){t.generateCachedItems()})},t.prototype.handleError=function(t){throw this.emit("error",t),new Error(t)},t.prototype.log=function(t){this.debug&&console.log(t)},Object.defineProperties(t.prototype,e),t}(p)),Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=index.min.js.map
