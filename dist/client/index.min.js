var MockeClient=function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(Boom),s={};function o(t,e){for(var r=0,n=t.length-1;0<=n;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;)t.unshift("..");return t}function r(t){return i.exec(t).slice(1)}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function c(){for(var t=arguments,e="",r=!1,n=arguments.length-1;-1<=n&&!r;n--){var i=0<=n?t[n]:"/";if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i.charAt(0))}return(r?"/":"")+(e=o(f(e.split("/"),function(t){return!!t}),!r).join("/"))||"."}function a(t){var e=u(t),r="/"===p(t,-1);return(t=!(t=o(f(t.split("/"),function(t){return!!t}),!e).join("/"))&&!e?".":t)&&r&&(t+="/"),(e?"/":"")+t}function u(t){return"/"===t.charAt(0)}var h={extname:function(t){return r(t)[3]},basename:function(t,e){return t=r(t)[2],t=e&&t.substr(-1*e.length)===e?t.substr(0,t.length-e.length):t},dirname:function(t){var t=(e=r(t))[0],e=e[1];return t||e?t+(e=e&&e.substr(0,e.length-1)):"."},sep:"/",delimiter:":",relative:function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;0<=r&&""===t[r];r--);return r<e?[]:t.slice(e,r-e+1)}t=c(t).substr(1),e=c(e).substr(1);for(var n=r(t.split("/")),i=r(e.split("/")),s=Math.min(n.length,i.length),o=s,a=0;a<s;a++)if(n[a]!==i[a]){o=a;break}for(var u=[],a=o;a<n.length;a++)u.push("..");return(u=u.concat(i.slice(o))).join("/")},join:function(){return a(f(Array.prototype.slice.call(arguments,0),function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},isAbsolute:u,normalize:a,resolve:c};function f(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var p="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)};function l(){}function v(){v.init.call(this)}function d(t){return void 0===t._maxListeners?v.defaultMaxListeners:t._maxListeners}function m(t,e,r,n){var i,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');return(i=t._events)?(i.newListener&&(t.emit("newListener",e,r.listener||r),i=t._events),s=i[e]):(i=t._events=new l,t._eventsCount=0),s?("function"==typeof s?s=i[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),s.warned||(n=d(t))&&0<n&&s.length>n&&(s.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=t,n.type=e,n.count=s.length,n=n,"function"==typeof console.warn?console.warn(n):console.log(n))):(s=i[e]=r,++t._eventsCount),t}function g(t,e,r){var n=!1;function i(){t.removeListener(e,i),n||(n=!0,r.apply(t,arguments))}return i.listener=r,i}function y(t){var e=this._events;if(e){t=e[t];if("function"==typeof t)return 1;if(t)return t.length}return 0}function _(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}l.prototype=Object.create(null),(v.EventEmitter=v).usingDomains=!1,v.prototype.domain=void 0,v.prototype._events=void 0,v.prototype._maxListeners=void 0,v.defaultMaxListeners=10,v.init=function(){this.domain=null,v.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new l,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},v.prototype.getMaxListeners=function(){return d(this)},v.prototype.emit=function(t){var e,r,n,i=arguments,s="error"===t,o=this._events;if(o)s=s&&null==o.error;else if(!s)return!1;if(a=this.domain,s){if(s=arguments[1],a)return(s=s||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,s.domain=a,s.domainThrown=!1,a.emit("error",s),!1;if(s instanceof Error)throw s;var a=new Error('Uncaught, unspecified "error" event. ('+s+")");throw a.context=s,a}if(!(e=o[t]))return!1;var u,c="function"==typeof e;switch(u=arguments.length){case 1:!function(t,e,r){if(e)t.call(r);else for(var n=t.length,i=_(t,n),s=0;s<n;++s)i[s].call(r)}(e,c,this);break;case 2:!function(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,s=_(t,i),o=0;o<i;++o)s[o].call(r,n)}(e,c,this,arguments[1]);break;case 3:!function(t,e,r,n,i){if(e)t.call(r,n,i);else for(var s=t.length,o=_(t,s),a=0;a<s;++a)o[a].call(r,n,i)}(e,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,r,n,i,s){if(e)t.call(r,n,i,s);else for(var o=t.length,a=_(t,o),u=0;u<o;++u)a[u].call(r,n,i,s)}(e,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(u-1),n=1;n<u;n++)r[n-1]=i[n];!function(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,s=_(t,i),o=0;o<i;++o)s[o].apply(r,n)}(e,c,this,r)}return!0},v.prototype.addListener=function(t,e){return m(this,t,e,!1)},v.prototype.on=v.prototype.addListener,v.prototype.prependListener=function(t,e){return m(this,t,e,!0)},v.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,g(this,t,e)),this},v.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,g(this,t,e)),this},v.prototype.removeListener=function(t,e){var r,n,i,s,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[t]))return this;if(r===e||r.listener&&r.listener===e)0==--this._eventsCount?this._events=new l:(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,s=r.length;0<s--;)if(r[s]===e||r[s].listener&&r[s].listener===e){o=r[s].listener,i=s;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new l,this;delete n[t]}else!function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,i);n.removeListener&&this.emit("removeListener",t,o||e)}return this},v.prototype.removeAllListeners=function(t){var e,r=this._events;if(!r)return this;if(!r.removeListener)return 0===arguments.length?(this._events=new l,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new l:delete r[t]),this;if(0===arguments.length){for(var n,i=Object.keys(r),s=0;s<i.length;++s)"removeListener"!==(n=i[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new l,this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)for(;this.removeListener(t,e[e.length-1]),e[0];);return this},v.prototype.listeners=function(t){var e=this._events,r=e&&(r=e[t])?"function"==typeof r?[r.listener||r]:function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(r):[];return r},v.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},v.prototype.listenerCount=y,v.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var E=function(i){function t(t,e,r,n){void 0===n&&(n={}),i.call(this),this.app=r,this.faker=n,this.name=t,this.configured=!1,this.items=[],this.startService(e)}i&&(t.__proto__=i),(t.prototype=Object.create(i&&i.prototype)).constructor=t;var e={total:{configurable:!0}};return e.total.get=function(){return this.items.length},t.prototype.startService=function(t){if("string"==typeof(e=t))var t=s.readFileSync(e,{encoding:"utf8"}),e=JSON.parse(t);else if(Array.isArray(e)||"object"!=typeof e)throw new Error('Options type cannot be "',typeof e,'"');this.configureService(e)},t.prototype.configureService=function(t){var e=t.schema,t=t.total;void 0===t&&(t=10),this.schema=e=void 0===e?{}:e,this._total=t,this.app._server&&this.registerRoutes()},t.prototype.registerRoutes=function(){var i=this,t=[{method:"GET",path:"/"+this.name+"/{id}",handler:function(e){var t=i.items.filter(function(t){return t.id===parseInt(e.params.id)})[0];if(t)return t;i.app.handleError("notFound","Item not found")}},{method:["POST","PUT"],path:"/"+this.name+"/{id}",handler:function(e){var r=e.payload,n=i.items.filter(function(t){return t.id===parseInt(e.params.id)})[0];if(n)return Object.keys(i.schema).forEach(function(t){!r[t]&&null!==r[t]||(n[t]=r[t])}),n;i.app.handleError("notFound","Item not found")}},{method:"DELETE",path:"/"+this.name+"/{id}",handler:function(e){var r=i.items.filter(function(t){return t.id===parseInt(e.params.id)})[0];if(r)return i.items=i.item.filter(function(t){return t.id!==r.id}),r;i.app.handleError("notFound","Item not found")}},{method:"GET",path:"/"+this.name,handler:function(n){return i.items.filter(function(t){var e=parseInt(n.query.limit)||4,r=parseInt(n.query.skip)||0;return t.id<=e+r&&t.id>r})}},{method:["POST","PUT"],path:"/"+this.name,handler:function(t){t=i.generateItem(null,t.payload);return i.items.push(t),t}}];this.app._server.route(t)},t.prototype.generateCachedItems=function(){this.items=[];for(var t=0;this._total>t;t++){var e=this.generateItem();this.items.push(e)}this.app.log("generated "+this.items.length+" for service "+this.name)},t.prototype.generateItem=function(t,e){void 0===e&&(e={});for(var r=t||this.schema,n=Object.keys(r),i={id:e.id||this.items.length+1},s=0;n.length>s;s++){var o=n[s];e[o]?i[o]=e[o]:i[o]=this.generateProperty(r[o])}return i},t.prototype.generateProperty=function(t){var e=t.type;void 0===e&&(e="string");var r=t.total;void 0===r&&(r=4);var n=t.properties;void 0===n&&(n={});t=t.fakerType;if(void 0===t&&(t="lorem.text"),this.faker){if("array"===e)return this.generatePropertyArray({type:e,total:r,properties:n,fakerType:t});if("object"===e)return this.generateItem(n,1);t=t.split(".");return t.length<2&&this.app.handleError("missing props: "+t+" "+Object.keys(n).join(", ")+" "+e),(this.faker[t[0]][t[1]]||this.faker.lorem.text)()}},t.prototype.generatePropertyArray=function(t){var e=t.type;void 0===e&&(e="string");var r=t.total;void 0===r&&(r=4);var n=t.properties;void 0===n&&(n={});var i=t.fakerType;if(void 0===i&&(i="lorem.text"),this.faker){for(var s,o=[],a=0;a<r;a++)"object"===i?(s=this.generateItem(n,a+1),o.push(s)):((s=i.split(".")).length<2&&this.app.handleError("missing props: "+s+" "+Object.keys(n).join(", ")+" "+e),s=(s=this.faker[s[0]][s[1]])||this.faker.lorem.text,o.push(s()));return o}},t.prototype.destroy=function(){this.removeAllListeners()},t.prototype.create=function(t){var e=this;return this.app.transport.post(""+this.name,t).then(function(t){return t}).catch(function(t){t=t.response.data.message;e.emit("error",t)})},t.prototype.patch=function(t,e){var r=this;return this.app.transport.post(this.name+"/"+t,e).then(function(t){return t}).catch(function(t){t=t.response.data.message;r.emit("error",t)})},t.prototype.delete=function(t){var e=this;return this.app.transport.delete(this.name+"/"+t).then(function(t){return t}).catch(function(t){t=t.response.data.message;e.emit("error",t)})},t.prototype.find=function(t){var e=this,r=t.limit,t=t.skip;return this.app.transport.get(this.name+"?limit="+(r=void 0===r?4:r)+"&skip="+(t=void 0===t?0:t)).then(function(t){return{data:t.data,total:t.total}}).catch(function(t){t=t.response.data.message;e.emit("error",t)})},t.prototype.get=function(t){var e=this;return this.app.transport.get(this.name+"/"+(t=void 0===t?1:t)).then(function(t){return t.data}).catch(function(t){t=t.response.data.message;e.emit("error",t)})},t.prototype.createStore=function(){var n=this;return{namespaced:!0,state:{items:[],total:0,isFindPending:!1,isGetPending:!1,isCreatePending:!1,isPatchPending:!1,isDeletePending:!1},mutations:{ADD_ITEM_TO_STORE:function(t,e){var r=!!t.items.map(function(t,e){return Object.assign({},t,{index:e})}).filter(function(t){return t.id===e.id})[0];r?t.items=t.items.splice(r.index,1,e):t.items.push(e)},UPDATE_TOTAL:function(t,e){t.total=e},IS_CREATE_PENDING:function(t){t.isCreatePending=!0},CREATE_FINISHED:function(t){t.isCreatePending=!1},IS_PATCH_PENDING:function(t){t.isPatchPending=!0},PATCH_FINISHED:function(t){t.isPatchPending=!1},IS_DELETE_PENDING:function(t){t.isDeletePending=!0},DELETE_FINISHED:function(t){t.isDeletePending=!1},IS_FIND_PENDING:function(t){t.isFindPending=!0},FIND_FINISHED:function(t){t.isFindPending=!1},IS_GET_PENDING:function(t){t.isGetPending=!0},GET_FINISHED:function(t){t.isGetPending=!1}},actions:{findItems:function(t,e){var r=t.commit,t=e.limit,e=e.skip;return r("IS_FIND_PENDING"),n.find({limit:t,skip:e}).then(function(t){return r("UPDATE_TOTAL",t.total),t.data.forEach(function(t){r("ADD_ITEM_TO_STORE",t)}),t}).finally(function(t){return r("FIND_FINISHED"),t})},getItem:function(t,e){var r=t.commit;return r("IS_GET_PENDING"),n.get(e).then(function(t){return r("ADD_ITEM_TO_STORE",t),t}).finally(function(t){return r("GET_FINISHED"),t})},createItem:function(t,e){var r=t.commit;return r("IS_CREATE_PENDING"),n.create(e).then(function(t){return r("ADD_ITEM_TO_STORE",t),t}).finally(function(t){return r("CREATE_FINISHED"),t})},patchItem:function(t,e){var r=t.commit,t=e.id,e=e.params;return r("IS_PATCH_PENDING"),n.patch(t,e).then(function(t){return r("ADD_ITEM_TO_STORE",t),t}).finally(function(t){return r("PATCH_FINISHED"),t})},deleteItem:function(t,e){var r=t.commit;return r("IS_PATCH_PENDING"),n.delete(e).then(function(t){return r("ADD_ITEM_TO_STORE",t),t}).finally(function(t){return r("PATCH_FINISHED"),t})}},getters:{getById:function(t){return function(e){return t.items.filter(function(t){return t.id===e})[0]}},findInStore:function(n){return function(t){var e=t.limit;void 0===e&&(e=4);var r=t.skip;return void 0===r&&(r=0),n.items.filter(function(t){return t.id<=e+r&&t.id>r})}}}}},Object.defineProperties(t.prototype,e),t}(v);return t.MockerClient=function(e){function t(t){e.call(this,t),t.transport&&(this.transport=t.transport.create({baseURL:"http://"+this._host+":"+this._port+"/"})),this.registerServices()}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.createVuexModules=function(){var e=this,r={};return Object.keys(this.services).forEach(function(t){r[t]=e.services[t].createStore()}),r},t}(function(a){function t(t){var r=this,e=t.port;void 0===e&&(e=3001);var n=t.host;void 0===n&&(n="localhost");var i=t.services;void 0===i&&(i={});var s=t.servicesPath,o=t.customRoutes;void 0===o&&(o=[]);t=t.debug;void 0===t&&(t=!1),a.call(this),this.services={},this.faker={},this._host=n,this._port=e,this._services=i,this._servicesPath=s,this._customRoutes=o,this.debug=t,this.transport={get:function(t){return r.transportGet(t)},post:function(t,e){return r.transportPost(t,e)},put:function(t,e){return r.transportPost(t,e)},delete:function(t){return r.transportDelete(t)}}}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={host:{configurable:!0},port:{configurable:!0},servicesRegistered:{configurable:!0}};return e.host.get=function(){return this._host},e.port.get=function(){return this._port},e.servicesRegistered.get=function(){return Object.keys(this.services)},t.prototype.registerServices=function(){var r,n=this;this.services={},this._servicesPath?(r=h.join(this._servicesPath),s.readdirSync(r).forEach(function(t){var e=n.checkFile(t);e&&n.registerService(e,r+"/"+t)})):this._services&&0<Object.keys(this._services).length?Object.keys(this._services).forEach(function(t){var e=n._services[t];n.registerService(t,e)}):this.handleError("No services found"),0===this.servicesRegistered.length&&this.handleError("No services found")},t.prototype.registerService=function(t,e){this.log("Registering "+t+" service");e=new E(t,e,this,this.faker);this.services[t]=e,this.log(t+" registered"),this.log(this.servicesRegistered)},t.prototype.transportGet=function(t){if(t||this.handleError("No path"),t.includes("?")){var e=t.split("?")[0],r=t.split("?")[1],n=r.split("&").filter(function(t){return t.includes("limit")})[0],i=r.split("&").filter(function(t){return t.includes("skip")})[0],n=parseInt(n.split("=")[1]),i=parseInt(i.split("=")[1]),r=this.service(e).items.filter(function(t){return t.id<=n+i&&t.id>i}),e=this.service(e).items.length;return Promise.resolve({data:r,total:e})}var e=t.split("/")[0],s=t.split("/")[1];return Promise.resolve({data:this.service(e).items.filter(function(t){return t.id===parseInt(s)})[0]})},t.prototype.transportPost=function(t,e){t?e?"object"==typeof e&&!Array.isArray(e)||this.handleError("Wrong data type"):this.handleError("No data"):this.handleError("No path");var r=t.split("/")[0],t=t.split("/")[1];if(t){var n=this.service(r).get(t),i=this.service(r).schema;return Object.keys(i).forEach(function(t){!e[t]&&null!==e[t]||(n[t]=e[t])}),Promise.resolve(n)}i=Object.assign({},e,{id:this.service(r).items.length});return this.service(r).items.push(i),Promise.resolve(i)},t.prototype.transportDelete=function(t){t?r?["number","string"].includes(typeof body)&&this.handleError("Wrong id type"):this.handleError("No id"):this.handleError("No path");var e=t.split("/")[0],r=parseInt(t.split("/")[1]),t=this.service(e).get(r);return t?(this.service(e).items=this.service(e).items.filter(function(t){return t.id!==parseInt(r)}),Promise.resolve(t)):Promise.reject(new Error("Item does not exist"))},t.prototype.checkFile=function(t){t=t.split(".");return"json"===t.pop()?t.join("."):null},t.prototype.service=function(t){return this.services[t]||this.handleError("No service with the name "+t+" registered"),this.services[t]},t.prototype.seedServices=function(){Object.values(this.services).forEach(function(t){t.generateCachedItems()})},t.prototype.handleError=function(t,e){var r=e||t;throw e?this.emit("error",n.default[t](r)):this.emit("error",new Error(r))},t.prototype.log=function(t){this.debug&&console.log(t)},Object.defineProperties(t.prototype,e),t}(v)),Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=index.min.js.map
